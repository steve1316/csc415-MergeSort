/*
Name: Steve Tu
Class: CSC415-01
Date: 09/05/19
*/

interface MergeSort<T>
{
    void sort(T[] items);
}

class MergeSortImpl<T extends Comparable<T>> implements MergeSort<T>
{
    public void sort(Comparable[] myArray)
    {
        //Set up left and right values for sorting.
        int left = 0;
        int right = myArray.length - 1;

        //Create another array to hold a copy of myArray.
        Comparable[] tempArray = new Comparable[myArray.length];

        //Copy over the unknown data types from myArray into tempArray.
        copyArray(myArray, tempArray);

        //mergeSort(tempArray, 0, myArray.length, myArray);
        mergeSort(myArray, tempArray, 0, myArray.length);
    }

    public void copyArray(Comparable[] myArray, Comparable[] tempArray)
    {
        for(int i = 0; i < myArray.length; i++)
        {
            tempArray[i] = myArray[i];
        }
    }

    public void mergeSort(Comparable[] myArray, Comparable[] tempArray, int start, int end)
    {
        //Stop the recursive calls if the array is completely sorted.
        if(end - start < 2)
        {
            return;
        }

        //Set up middle value to split myArray.
        int middle = (start + end) / 2;

        //Sort the left side of myArray.
        mergeSort(myArray, tempArray, start, middle);

        //Sort the right side of myArray.
        mergeSort(myArray, tempArray, middle, end);

        //After a recursive call, merge the arrays together while sorting them.
        //merge(B, iBegin, iMiddle, iEnd, A);
        merge(myArray, tempArray, start, middle, end);
    }

    public void merge(Comparable[] myArray, Comparable[] tempArray, int start, int middle, int end)
    {
        int i = start;
        int j = middle;

        for(int k = start; k < end; k++)
        {
            if(i < middle && (j >= end || tempArray[i].compareTo(tempArray[j]) <= 0))
            {
                myArray[k] = tempArray[i];
                i++;
            }
            else
            {
                myArray[k] = tempArray[j];
                j++;
            }
        }
    }
}

public class Tester
{
    public static void main(String args[])
    {
        System.out.println("\nWelcome to my Merge Sort Program!");
        System.out.println("----------------");

        //Array of data types to be sorted. I'm using Integer objects as an example. Also works with string array.
        //Integer[] myArray = new Integer[] {1, 5, 2, 7, 9, 6, 4, 8, 10, 3};
        String[] myArray = new String[] {"Extreme", "Berries", "Fair", "Copper", "Apple", "Deer"};

        //Print out myArray unsorted first.
        System.out.println("Unsorted Array:");
        for (int i = 0; i < myArray.length; i++) {
            System.out.println(myArray[i].toString());
        }

        //Create an instance of MergeSortImpl
        MergeSortImpl mergeSort = new MergeSortImpl();

        //Pass myArray to mergeSort and then sort the array of unknown data types.
        mergeSort.sort(myArray);

        //Then print out the resultant array sorted.
        System.out.println("\n----------------");
        System.out.println("Sorted Array:");
        for (int i = 0; i < myArray.length; i++) {
            System.out.println(myArray[i].toString());
        }

        System.exit(0);
    }
}